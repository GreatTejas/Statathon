<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>CSV Cleaner</title>
  </head>
  <body>
    <h2>Upload CSV for Cleaning</h2>
    <input type="file" id="file" accept=".csv"/>
    <button id="go">Upload & Clean</button>

    <script>
      document.getElementById('go').addEventListener('click', async () => {
        const f = document.getElementById('file').files[0];
        if (!f) {
          alert('Select a CSV file first');
          return;
        }
        const form = new FormData();
        form.append('file', f);

        const resp = await fetch('/upload', {
          method: 'POST',
          body: form
        });

        if (!resp.ok) {
          const text = await resp.text();
          alert('Upload failed: ' + text);
          return;
        }

        const blob = await resp.blob();
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'cleaned.csv';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });
    </script>
  </body>
</html>
